# HTTPS

<br>

## 배경

HTTP의 보안 문제
- HTTP는 텍스트 교환이므로, 누군가 네트워크에서 신호를 가로채면 내용이 노출되는 보안 이슈가 존재
- 통신 상대를 확인하지 않기 때문에 위장한 상대에게 요청,응답을 보낸 수도 있다.
- 메세지의 내용이 변조되어 도착하는 중간자 공격을 막을 수 없다.


## HTTPS(HyperText Transger Protocol Secure)
HTTP프로토콜에 ssl 또는 tls계층을 추가하여 메세지 중 바디의 보안을 강화한 프로토콜

- 공개키와 대칭키를 사용하여 메시지 암호화, 인증서를 통해 상대 증명, 디지털 서명을 통해 데이터 위조 확인
    - SSL : 웹 서버와 사용자의 웹 브라우저 간 통신을 암호화하는 프로토콜
    - TSL : 보안 및 개인 정보 보호 기능이 강화 된 후속 프로토콜
- TCP/IP 443번 포트 사용
- HTTP는 TCP와 직접 통신했지만, HTTPS에서 HTTP는 SSL과 통신하고 SSL이 TCP와 통신


## 암호화 방식
HTTPS의 암호화 방식은 대칭키 + 비디칭키 방식 둘다 사용

### 공개키 방식 (비대칭키)
- 공개키, 비밀키(개인키) 사용
- 암호화시엔 공개키를 사용하고, 복호화시엔 양측에서 가지고 있는 비밀키 사용

### 대칭키
- 비밀키(개인키) 사용
- 양측에서 공개되지 않는 키를 가지고 암복호화 진행
- 클리이언트 서버간 통신은 대칭키 사용
- 인증기관 CA(Certificate Authority)와의 통신에서 비대칭키 방식 사용

### 동작 과정

![image](https://user-images.githubusercontent.com/92436863/229456756-ff361770-7ec8-4f96-8fd1-b1ba3c7c26b2.png)

![image](https://user-images.githubusercontent.com/92436863/229457163-e48095d6-abf3-402c-987a-83574c053dcd.png)

- 웹브라우저는 3에서 미리 알고 있던 인증기관의 공개키로 인증서를 해독하여 검증
그러면 사이트의 정보와 서버의 공개키를 알 수 있게 된다.

- 이렇게 얻은 서버의 공개키로 대칭키를 암호화해서 다시 사이트에 보냄

- 사이트는 개인키로 암호문을 해독하여 대칭키를 얻게 되고, 이제 대칭키로 데이터를 주고 받는다

![image](https://user-images.githubusercontent.com/92436863/229458223-13709056-4f24-4131-b59d-ad8919d525bd.png)


### SSL Handshake

![image](https://user-images.githubusercontent.com/92436863/229459232-77b2e796-6f97-4de3-901f-21318a23d7ee.png)

TCP의 3-way handshake 먼저 수행후(TCP 기반의 프로토콜이기 때문) 암호화 협상(SSL Handshake) 수행

- Client Hello : 브라우저가 사용하는 암호화 방식을 보내고 인증서 요구
- Server Hello : 서버가 지원하는 암호화 방식을 보내고 인증서 응답

- 브라우저는 인증서를 확인하고, 대칭키를 만들어 인증서의 공개키로 암호화하여 전송

- 서버는 대칭키를 사이트 개인키로 복호화하고, 다음부터 통신에 해당 대칭키 사용

